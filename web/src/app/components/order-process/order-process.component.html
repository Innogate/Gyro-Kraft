<p-stepper [value]="1" class="basis-[50rem]">
    <div class="card">
        <p-step-list>
            <p-step [value]="1">Cutting</p-step>
            <p-step [value]="2">Print</p-step>
            <p-step [value]="3">Stitch</p-step>
            <p-step [value]="4">Finishing</p-step>
            <p-step [value]="5">Packing</p-step>
            <p-step [value]="6">Reports</p-step>
        </p-step-list>
    </div>
    <p-step-panels>
        <p-step-panel [value]="1">
            <ng-template #content let-activateCallback="activateCallback">
                <div class="flex flex-col relative p-4 bg-white rounded border border-dashed border-gray-300">
                    <!-- Add Step button at top-right -->
                    <div class="flex justify-end gap-4 absolute top-4 right-4">
                        <button (click)="showAllPoQty()"
                            class="px-4 py-2 font-medium text-white rounded bg-emerald-600 hover:bg-emerald-500 transition-all flex items-center">
                            <i class="pi pi-serch mr-2"></i> Po Details
                        </button>

                        <button (click)="toggleForm()"
                            class="px-4 py-2 font-medium text-white rounded bg-emerald-600 hover:bg-emerald-500 transition-all flex items-center">
                            <i class="pi pi-plus mr-2"></i> Cutting Issue
                        </button>
                    </div>

                    <!-- Table centered in its container, full width -->
                    <div class="mt-10" *ngIf="poData && poData.length > 0">
                        <h1 class="text-2xl font-semibold text-gray-800 m-0 dark:text-white">PO Quantity Details</h1>
                        <app-dynamic-table [columns]="tableColumnsPoqt" [data]="poData"
                            (actionClicked)="handleAction($event)">
                        </app-dynamic-table>
                    </div>
                    <h1 class="text-2xl font-semibold text-gray-800 m-0 dark:text-white">Cutting Details</h1>
                    <div class="mt-10">
                        <app-dynamic-table [columns]="tableColumns" [data]="tableData"
                            [actions]="['Edit', 'Delete', 'Receive', 'Print']" (actionClicked)="handleAction($event)">
                        </app-dynamic-table>
                    </div>
                    <div *ngIf="tableDataReceive && tableDataReceive.length > 0">
                        <h1 class="text-2xl font-semibold text-gray-800 m-0 dark:text-white">Cutting Recive Details</h1>
                        <div class="mt-10">
                            <app-dynamic-table [columns]="tableColumnsReceive" [data]="tableDataReceive"
                                [actions]="['Edit']" (actionClicked)="handleAction($event)">
                            </app-dynamic-table>
                        </div>
                    </div>
                    <!-- Next button bottom-right -->
                    <div class="flex justify-end mt-6">
                        <p-button label="Next" icon="pi pi-arrow-right" iconPos="right"
                            (onClick)="activateCallback(2)" />
                    </div>
                </div>
            </ng-template>
        </p-step-panel>

        <p-step-panel [value]="2">
            <ng-template #content let-activateCallback="activateCallback">
                <div class="flex flex-col relative p-4 bg-white rounded border border-dashed border-gray-300">
                    <!-- Add Step button at top-right -->
                    <button (click)="toggleForm()"
                        class="absolute top-4 right-4 px-4 py-2 font-medium text-white rounded bg-emerald-600 hover:bg-emerald-500 transition-all">
                        <i class="mr-2 pi pi-plus"></i> Add Cutter
                    </button>

                    <!-- Table centered in its container, full width -->
                    <div class="mt-10">
                        <app-dynamic-table [columns]="tableColumns" [data]="tableData"
                            [actions]="['Edit', 'Delete', 'Recive']" (actionClicked)="handleAction($event)">
                        </app-dynamic-table>
                    </div>
                    <div class="flex pt-6 justify-between">
                        <p-button label="Back" severity="secondary" icon="pi pi-arrow-left"
                            (onClick)="activateCallback(1)" />
                        <p-button label="Next" icon="pi pi-arrow-right" iconPos="right"
                            (onClick)="activateCallback(3)" />
                    </div>
                    <!-- Next button bottom-right -->
                    <!-- <div class="flex justify-end mt-6">
                        <p-button label="Next" icon="pi pi-arrow-right" iconPos="right"
                            (onClick)="activateCallback(2)" />
                    </div> -->
                </div>

            </ng-template>
        </p-step-panel>

        <p-step-panel [value]="3">
            <ng-template #content let-activateCallback="activateCallback">
                <div class="flex flex-col h-48">
                    <div
                        class="border-2 border-dashed border-surface-200 dark:border-surface-700 rounded bg-surface-50 dark:bg-surface-950 flex-auto flex justify-center items-center font-medium">
                        Content III
                    </div>
                </div>
                <div class="flex pt-6 justify-start">
                    <p-button label="Back" icon="pi pi-arrow-left" iconPos="right" (onClick)="activateCallback(2)" />
                </div>
            </ng-template>
        </p-step-panel>
    </p-step-panels>
</p-stepper>

<!-- </div> -->
<p-dialog [header]="hedding" [(visible)]="showForm" [modal]="true" [style]="{ width: '90vw', maxWidth: '500px' }"
    [closable]="true" [dismissableMask]="true" [breakpoints]="{ '960px': '75vw', '640px': '90vw' }"
    [styleClass]="'p-0 overflow-hidden rounded-xl shadow-md'">
    <form [formGroup]="cuttingForm">
        <div class="space-y-4 bg-gray-50 sm:p-6 p-4 rounded-xl shadow-sm">
            <!-- Date Field -->
            <div class="flex flex-col sm:flex-row sm:items-end gap-4">
                <!-- Date Field -->
                <div class="w-full sm:w-1/2">
                    <label class="block font-medium mb-1 text-gray-700" for="date">
                        Date <span class="text-red-500">*</span>
                    </label>
                    <p-calendar formControlName="issue_date" dateFormat="dd-mm-yy" [showIcon]="true" appendTo="body"
                        [baseZIndex]="10000" [autoZIndex]="true">
                    </p-calendar>
                </div>

                <!-- Lot Number Field -->
                <div class="w-full sm:w-1/2">
                    <label class="block font-medium mb-1 text-gray-700">Delevary Date</label>
                    <p-calendar formControlName="delivery_date" dateFormat="dd-mm-yy" [showIcon]="true" appendTo="body"
                        [baseZIndex]="10000" [autoZIndex]="true">
                    </p-calendar>
                </div>
            </div>


            <!-- Cutter Name Dropdown -->
            <div>
                <label class="block font-medium mb-1 text-gray-700" for="cutterName">Select Cutter Name <span
                        class="text-red-500">*</span></label>
                <p-dropdown formControlName="cutter_id" [options]="CutterName" optionLabel="name" optionValue="id"
                    placeholder="Select Cutter Name" class="w-full" [showClear]="true"></p-dropdown>
            </div>

            <!-- PO Quantity Dropdown -->
            <div class="flex gap-4">
                <!-- Lot No Field -->
                <div class="w-1/2">
                    <label class="block font-medium mb-1 text-gray-700" for="lotno">Lot No</label>
                    <input type="text" formControlName="lot_no" placeholder="Enter Lot Number"
                        class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />
                </div>

                <!-- PO Detilce Field -->
                <div class="w-1/2">
                    <label class="block font-medium mb-1 text-gray-700" for="poQuantity">
                        Select PO Detilce <span class="text-red-500">*</span>
                    </label>
                    <div class="flex gap-2">
                        <input type="text" formControlName="po_qty_id" placeholder="Select PO Detilce" readonly
                            class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />
                        <button type="button" (click)="gateAllpoQty()"
                            class="px-4 py-2 font-medium text-white transition-all duration-200 rounded bg-blue-600 hover:bg-blue-500">
                            <i class="pi pi-plus"></i>
                        </button>
                    </div>
                </div>
            </div>




            <!-- Total Quantity Input -->
            <div>
                <label class="block font-medium mb-1 text-gray-700" for="totalQuantity">Total Quantity</label>
                <input type="number" formControlName="total_qty" placeholder="Enter Total Quantity"
                    class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />
            </div>
        </div>

        <div class="flex flex-col sm:flex-row sm:justify-end gap-4 mt-4">
            <button type="submit" (click)="submitCuttingForm('Add')" *ngIf="hedding !== 'Edit Cutting Step'"
                class="w-full sm:w-auto px-4 py-2 font-medium text-white transition-all duration-200 rounded bg-emerald-600 hover:bg-emerald-500">
                <i class="pi pi-check mr-2"></i> Save
            </button>

            <button type="submit" (click)="submitCuttingForm('Update')" *ngIf="hedding === 'Edit Cutting Step'"
                class="w-full sm:w-auto px-4 py-2 font-medium text-white transition-all duration-200 rounded bg-emerald-600 hover:bg-emerald-500">
                <i class="pi pi-check mr-2"></i> Update
            </button>

            <button type="button" (click)="showForm = false"
                class="w-full sm:w-auto px-4 py-2 font-medium text-gray-700 transition-all duration-200 rounded bg-gray-200 hover:bg-gray-300">
                <i class="pi pi-times mr-2"></i> Cancel
            </button>
        </div>

    </form>

</p-dialog>

<p-dialog header="Po details" [(visible)]="showPoQty" [modal]="true" [style]="{ width: '90vw', maxWidth: '500px' }"
    [closable]="true" [dismissableMask]="true" [breakpoints]="{ '960px': '75vw', '640px': '90vw' }"
    [styleClass]="'p-0 overflow-hidden rounded-xl shadow-md'">
    <div>
        <app-dynamic-table [columns]="tableColumnsPoqt" [data]="tableDatapoqt" (actionClicked)="handleAction($event)"
            (rowClicked)="handleRowClick($event)">
        </app-dynamic-table>
    </div>
</p-dialog>



<p-dialog [header]="ReceiveHedding" [(visible)]="ReceiveShowForm" [modal]="true"
    [style]="{ width: '90vw', maxWidth: '500px' }" [closable]="true" [dismissableMask]="true"
    [breakpoints]="{ '960px': '75vw', '640px': '90vw' }" [styleClass]="'p-0 overflow-hidden rounded-xl shadow-md'">
    <form [formGroup]="receiveForm">
        <div class="flex flex-col sm:flex-row sm:items-end gap-4">
            <!-- Date Field -->
            <div class="w-full sm:w-1/2">
                <label class="block font-medium mb-1 text-gray-700" for="cutterName">Received Date<span
                        class="text-red-500">*</span></label>
                <p-calendar formControlName="received_date" dateFormat="dd-mm-yy" [showIcon]="true" appendTo="body"
                    [baseZIndex]="10000" [autoZIndex]="true" class="w-full">
                </p-calendar>
            </div>
            <div class="w-full sm:w-1/2">

                <label class="block font-medium mb-1 text-gray-700" for="cutterName">Received Quentity<span
                        class="text-red-500">*</span></label>
                <input type="number" formControlName="received_qty" placeholder="Enter Received Quantity"
                    class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />
            </div>
        </div>

        <div class="flex flex-col sm:flex-row sm:items-end gap-4">
            <!-- Date Field -->
            <div class="w-full sm:w-1/2">

                <label class="block font-medium mb-1 text-gray-700" for="cutterName">Deffective Quentity<span
                        class="text-red-500">*</span></label>
                <input type="number" formControlName="deffective_qty" placeholder="Enter Deffective Quantity"
                    class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500" />
            </div>

            <div class="w-full sm:w-1/2">
                <label class="block font-medium mb-1 text-gray-700" for="cutterName">Remark<span
                        class="text-red-500"></span></label>
                <input formControlName="remark" placeholder="Enter Remark"
                    class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"
                    type="text" maxlength="1000" minlength="5" pattern="[a-zA-Z0-9\s.,-]*"
                    title="Only alphanumeric characters, spaces, commas, periods, and hyphens are allowed." />
            </div>
        </div>

        <div class="flex flex-col sm:flex-row sm:justify-end gap-4 mt-4">
            <button type="submit" (click)="submitReceiveForm('Add')" *ngIf="hedding !== 'Receive Cutting'"
                class="w-full sm:w-auto px-4 py-2 font-medium text-white transition-all duration-200 rounded bg-emerald-600 hover:bg-emerald-500">
                <i class="pi pi-check mr-2"></i> Receive
            </button>

            <!-- <button type="submit" (click)="submitCuttingForm('Update')" *ngIf="hedding === 'Edit Cutting Step'"
                class="w-full sm:w-auto px-4 py-2 font-medium text-white transition-all duration-200 rounded bg-emerald-600 hover:bg-emerald-500">
                <i class="pi pi-check mr-2"></i> Update
            </button> -->

            <button type="button" (click)="ReceiveShowForm = false"
                class="w-full sm:w-auto px-4 py-2 font-medium text-gray-700 transition-all duration-200 rounded bg-gray-200 hover:bg-gray-300">
                <i class="pi pi-times mr-2"></i> Cancel
            </button>
        </div>
    </form>

</p-dialog>
